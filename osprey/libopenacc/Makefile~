ACCCC = gcc

ACCCFLAGS = -fPIC -Wall -g
ACCINCL = -I. -I/opt/cuda/5.0/include
ACCOPT = -O3

ACCDYNAMIC_LIBS = -lcuda -lcudart -lpthread
ACCLIBS = -L/opt/cuda/5.0/lib64 $(DYNAMIC_LIBS)

ACCLD = gcc
ACCLDFLAGS = -g -shared

ACCTARGET = libopenacc.so

ACCSRCDIR = .
#SRCS = $(wildcard $(SRCDIR)/*.c)
ACCSRCS = acc_context.c acc_data.c acc_kernel.c  acc_util.c hashmap.c vector.c synch.c
ACCOBJS = $(patsubst %.c, %.o, $(SRCS))

all: $(ACCTARGET)

$(ACCTARGET): $(ACCOBJS)
	$(ACCLD) $(ACCLDFLAGS) $^ -o $@ $(ACCLIBS)
	@rm -f *.o

%.o: %.c
	$(CC) $(CFLAGS) $(OPT) $(INCL) -c $< -o $@

clean:
	@rm -f *.o
